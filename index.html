<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Avaliação do Paciente Crítico</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f6fa;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #4a69bd;
      color: white;
      padding: 15px;
      text-align: center;
    }
    #dashboard, #avaliacao {
      padding: 20px;
    }
    .card {
      background: #fff;
      border-radius: 12px;
      padding: 15px;
      margin: 10px 0;
      box-shadow: 0px 4px 6px rgba(0,0,0,0.1);
      cursor: pointer;
    }
    button {
      padding: 10px 15px;
      margin: 5px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .btn-add { background-color: #4cd137; color: white; }
    .btn-remove { background-color: #e84118; color: white; }
    .btn-back { background-color: #718093; color: white; }
    .btn-save { background-color: #273c75; color: white; }
    textarea, select, input {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <header>
    <h2>Dashboard - Pacientes Críticos</h2>
  </header>

  <!-- DASHBOARD -->
  <div id="dashboard">
    <button class="btn-add" onclick="adicionarLeito()">Adicionar Leito</button>
    <div id="lista-leitos"></div>
  </div>

  <!-- AVALIAÇÃO -->
  <div id="avaliacao" style="display:none;">
    <h3 id="titulo-leito"></h3>
    <form id="form-avaliacao">
      <label>A - Airway (Via Aérea)</label>
      <textarea id="airway"></textarea>
      
      <label>B - Breathing (Respiração)</label>
      <textarea id="breathing"></textarea>
      
      <label>C - Circulation (Circulação)</label>
      <textarea id="circulation"></textarea>
      
      <label>D - Disability (Neurológico)</label>
      <textarea id="disability"></textarea>
      
      <label>E - Exposure (Exposição)</label>
      <textarea id="exposure"></textarea>

      <button type="button" class="btn-save" onclick="salvarAvaliacao()">Salvar Avaliação</button>
      <button type="button" class="btn-back" onclick="voltarDashboard()">Voltar</button>
    </form>
  </div>

  <script>
    // Configuração Firebase
   const firebaseConfig = {
  apiKey: "AIzaSyAh4cDk7h-x0IekJyQEvP4FUbHds6z7Dtc",
  authDomain: "passagem-plantao2025.firebaseapp.com",
  projectId: "passagem-plantao2025",
  storageBucket: "passagem-plantao2025.firebasestorage.app",
  messagingSenderId: "46390981643",
  appId: "1:46390981643:web:158251408fe14ac4ba030e"
};
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let leitos = [];
    let leitoAtual = null;

    function renderizarLeitos() {
      const lista = document.getElementById('lista-leitos');
      lista.innerHTML = '';
      leitos.forEach((leito, i) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <strong>${leito}</strong>
          <button class='btn-remove' onclick='removerLeito(${i})'>Remover</button>
        `;
        card.onclick = () => abrirAvaliacao(leito);
        lista.appendChild(card);
      });
    }

    function adicionarLeito() {
      const nome = prompt('Digite o nome do leito:');
      if (nome) {
        leitos.push(nome);
        renderizarLeitos();
      }
    }

    function removerLeito(index) {
      leitos.splice(index, 1);
      renderizarLeitos();
    }

    function abrirAvaliacao(leito) {
      leitoAtual = leito;
      document.getElementById('dashboard').style.display = 'none';
      document.getElementById('avaliacao').style.display = 'block';
      document.getElementById('titulo-leito').innerText = `Avaliação - ${leito}`;

      // Carregar dados salvos
      db.collection("avaliacoes").doc(leito).get().then(doc => {
        if (doc.exists) {
          const dados = doc.data();
          document.getElementById('airway').value = dados.airway || '';
          document.getElementById('breathing').value = dados.breathing || '';
          document.getElementById('circulation').value = dados.circulation || '';
          document.getElementById('disability').value = dados.disability || '';
          document.getElementById('exposure').value = dados.exposure || '';
        }
      });
    }

    function salvarAvaliacao() {
      const dados = {
        airway: document.getElementById('airway').value,
        breathing: document.getElementById('breathing').value,
        circulation: document.getElementById('circulation').value,
        disability: document.getElementById('disability').value,
        exposure: document.getElementById('exposure').value,
        timestamp: new Date()
      };

      db.collection("avaliacoes").doc(leitoAtual).set(dados)
        .then(() => alert('Avaliação salva com sucesso!'));
    }

    function voltarDashboard() {
      document.getElementById('dashboard').style.display = 'block';
      document.getElementById('avaliacao').style.display = 'none';
    }
  </script>
</body>
</html>
